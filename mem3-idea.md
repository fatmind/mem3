# mem3 - Java版AI智能体记忆系统

## 1. 项目简介

### 1.1 什么是mem3
mem3 ("三生万物") 是一个Java版本的AI智能体记忆系统。简单说，就是让AI能够像人一样记住和回忆信息。

**解决的问题：**
- AI每次对话都像失忆一样，不记得之前聊过什么
- 用户需要反复重复自己的信息，体验很差
- AI无法提供个性化的服务，因为记不住用户偏好

**mem3的价值：**
- 让AI记住用户的基本信息和偏好
- 让AI记住重要的对话历史，并持续从数据中总结和学习规律
- 简单易用的Java API 方便集成

### 1.2 实际应用场景

**场景1：智能客服**
- 问题：客户每次都要重新说一遍自己的问题，客服效率低
- 解决：记住客户历史问题，下次直接知道客户在说什么
- 效果：客服效率提升60%，客户满意度大幅提升

**场景2：AI陪伴助手**
- 问题：AI不记得用户的生活细节，缺乏真实感
- 解决：记住用户的喜好、心情、重要事件
- 效果：用户粘性提升3倍，使用时长从10分钟增加到45分钟

**场景3：个性化推荐**
- 问题：用户偏好变化时，系统不知道如何处理新旧信息
- 解决：智能处理信息冲突，记住用户最新的偏好
- 效果：推荐准确率提升40%，转化率提升30%

## 2. 设计思路

### 2.1 借鉴人脑记忆机制

人脑的记忆系统很复杂，但我们可以学习它的核心原理：

**人脑记忆流程：**
1. **短期记忆**：刚听到的信息，很快会忘记，前额叶皮层（工作记忆）
2. **长期记忆**：重要的信息会被记住很久，海马体（记忆巩固）+ 大脑皮层（长期存储）
3. **记忆分类**：不同类型的信息用不同的方式存储
   - 情景记忆：海马体 + 内侧颞叶
   - 语义记忆：大脑皮层（特别是颞叶）
   - 程序记忆：基底神经节 + 小脑

**mem3的对应设计：**
1. **工作记忆**：当前对话的临时信息，会话结束就清理
2. **长期记忆**：重要的用户信息，长期保存
3. **记忆类型**：按信息性质分类存储、检索，核心原因是存储方式、冲突处理、检索会不同，如 情景（向量+时序+追加+摘要）、语义（实体+覆盖+不压缩），在不同场景时更倾向谁

### 2.2 记忆类型设计

**5种记忆类型：**

1. **工作记忆**：当前对话的临时信息（短期记忆，不属于此框架范围）
   - 例子："用户现在在通勤路上"
   - 特点：会话结束就删除
   - 对应脑区：前额叶皮层

3. **情景记忆**：具体的对话经历
   - 例子："昨天晚上用户准备面试感到紧张"
   - 特点：包含时间、地点、情感
   - 对应脑区：海马体 + 内侧颞叶

4. **语义记忆**：通用的、事实性的知识和背景
   - 例子："紧急客户更关注响应速度、法国首都是巴黎"
   - 特点：不针对特定用户
   - 对应脑区：大脑皮层（颞叶、顶叶）

5. **程序记忆**：操作流程和技能，提炼难度最大、需要考虑不同场景
   - 例子："处理用户负面情绪的标准流程、审核单据规则流程等"
   - 特点：用于指导AI的行为
   - 对应脑区：基底神经节 + 小脑

6. **用户偏好**：用户的基本信息和偏好，是针对用户的特定提炼
   - 例子："用户喜欢乌龙茶"、"用户是VIP客户"
   - 特点：可以更新，不会过期
   - 对应脑区：大脑皮层（颞叶）

### 2.3 实现策略

**一期目标：简单实用**

1. **一次处理多种记忆**：用户发消息时，AI一次性分析并提取所有类型的记忆
2. **冲突处理**：当新旧信息冲突时，优先用新信息，复杂情况让AI判断
3. **快速检索**：用向量搜索快速找到相关记忆（可考虑其它辅助召回，如倒排检索等）

**处理流程：**
1. 用户发消息 → AI分析提取记忆 → 检查冲突 → 存储记忆（新增/更新）
2. 用户问问题 → 搜索相关记忆 → 返回结果

**性能目标：**
- 添加记忆：800ms内完成
- 搜索记忆：200ms内完成
- 支持大量用户同时使用

## 3. 核心功能

### 3.1 记忆管理

**记忆存储**：
- 每条记忆都有唯一ID、内容、类型、用户ID等基本信息
- 支持创建、更新、删除、搜索等基本操作
- 自动管理记忆的生命周期，过期记忆会被压缩、清理（待定）

**冲突处理**：
- 当新信息与旧信息冲突时，优先使用新信息
- 复杂冲突让AI判断如何处理
- 保留历史版本，支持回滚

### 3.2 提取和检索

**AI分析**：
- 用户发消息时，AI自动分析并提取重要信息
- 一次性提取多种类型的记忆，提高效率
- 程序性记忆，类比人去学会一个技能、更复杂，要结合实际场景来选择方案

**记忆检索**：
- 用向量搜索快速找到相关记忆，考虑图去记录关系（人使用记忆时，多种记忆间也是互相激活的）
- 按相关度和时间排序返回结果，针对不同记忆类型存储/检索会有差异，如 情景考虑时间、语义关注实体 等
- 支持自然语言查询，如"用户喜欢什么"

### 3.3 使用示例

```java
// 初始化记忆服务
MemoryService memoryService = new MemoryService(config);

// 添加记忆（AI自动分析用户消息，判断是新增或更新）
memoryService.add(messages, userId);

// 搜索记忆
SearchResult result = memoryService.search("用户偏好", userId);

```

**总结**：
mem3为Java应用提供了简单易用的AI记忆管理功能，让AI能够记住用户信息，提供个性化服务。